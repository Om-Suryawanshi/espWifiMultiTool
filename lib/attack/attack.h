#include <Arduino.h>
#include <ESP8266WiFi.h>
#include <LittleFS.h>

class Attack
{
public:
    Attack();
    void startBeacon();
    void stopBeacon();
    bool loadSSIDs(const char* filename);

private:
    uint8_t mac[6] = {0xAA, 0xBB, 0xCC, 0x00, 0x11, 0x22};
    std::vector<String> ssids;

    uint8_t beaconPacket[109] = {
        /* 0 -  3 */ 0x80, 0x00, 0x00, 0x00,
        /* 4 -  9 */ 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
        /* 10 - 15 */ 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
        /* 16 - 21 */ 0x01, 0x02, 0x03, 0x04, 0x05, 0x06,
        /* 22 - 23 */ 0x00, 0x00,
        /* 24 - 31 */ 0x83, 0x51, 0xf7, 0x8f, 0x0f, 0x00, 0x00, 0x00,
        /* 32 - 33 */ 0x64, 0x00,
        /* 34 - 35 */ 0x31, 0x00,
        /* 36 - 37 */ 0x00, 0x20,
        /* 38 - 69 */ 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                      0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                      0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                      0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
        /* 70 - 71 */ 0x01, 0x08,
        /* 72 - 79 */ 0x82, 0x84, 0x8b, 0x96, 0x24, 0x30, 0x48, 0x6c,
        /* 80 - 81 */ 0x03, 0x01,
        /* 82      */ 0x01,
        /* 83 - 108*/ 0x30, 0x18, 0x01, 0x00, 0x00, 0x0f, 0xac, 0x02,
                      0x02, 0x00, 0x00, 0x0f, 0xac, 0x04, 0x00, 0x0f,
                      0xac, 0x04, 0x01, 0x00, 0x00, 0x0f, 0xac, 0x02,
                      0x00, 0x00
    };

    struct AttackType
    {
        bool active = false;
        uint16_t packetCounter = 0;
    };
    AttackType beacon;
};